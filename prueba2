<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pozo Mágico - Acertijos</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#c19a3a;--muted:#9aa4b2}
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#0b1020 0%, #0f172a 100%);font-family:Inter,system-ui,Segoe UI,Arial;color:#fff}
    .container{width:96%;max-width:760px;padding:20px;border-radius:16px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(193,154,58,0.08)}
    h1{margin:0 0 6px;font-size:22px;color:var(--accent)}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .player-row{display:flex;gap:10px;margin-bottom:14px}
    input[type=text]{flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:#fff}
    button{background:var(--accent);border:none;padding:12px 16px;border-radius:10px;color:#081019;font-weight:700;cursor:pointer}
    .card{background:rgba(255,255,255,0.02);padding:16px;border-radius:12px;margin-bottom:12px;border:1px solid rgba(255,255,255,0.02)}
    .question{font-size:18px;margin:0 0 8px}
    .hint{font-size:13px;color:var(--muted);margin:0 0 12px}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .result{font-weight:700;color:#00e6a8}
    .codebox{margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(193,154,58,0.12), rgba(255,255,255,0.02));color:var(--accent);font-weight:800;text-align:center}
    .small{font-size:13px;color:var(--muted)}
    @media(max-width:520px){.player-row{flex-direction:column}}
  </style>
</head>
<body>
  <div class="container">
    <h1>Pozo Mágico ✨ — Reto de Acertijos</h1>
    <p class="lead">Responde los 3 acertijos. Si aciertas los 3, recibirás la <strong>clave del ganador</strong> para canjear tu premio.</p>

    <div class="player-row">
      <input id="playerName" type="text" placeholder="Nombre del jugador (ej. Ana)" />
      <button id="startBtn">Comenzar</button>
    </div>

    <div id="gameArea" style="display:none">

      <div class="card" id="qCard">
        <div class="question" id="questionText"></div>
        <div class="hint" id="hintText"></div>
        <input id="answerInput" type="text" placeholder="Escribe tu respuesta aquí" />
        <div style="margin-top:10px;display:flex;gap:8px">
          <button id="submitBtn">Enviar respuesta</button>
          <button id="skipBtn" style="background:transparent;color:var(--accent);border:1px solid rgba(193,154,58,0.18)">Pista</button>
        </div>
      </div>

      <div class="card small">
        <div>Progreso: <span id="progress">0 / 3</span></div>
        <div>Puntos: <span id="score">0</span></div>
      </div>

      <div class="footer">
        <div class="small">Recuerda: respuestas en español. No uses tildes (opcional) para mayor compatibilidad.</div>
        <div id="status" class="small"></div>
      </div>

      <div id="finalArea" style="display:none">
        <div id="finalMessage" class="result"></div>
        <div id="winnerCodeArea" style="display:none">
          <div class="codebox">Clave ganadora:<br/><span id="winnerCode">PzMg0000001</span></div>
        </div>
        <div style="margin-top:12px"><button id="restartBtn" style="background:#1f2937;color: #fff;">Jugar otra vez</button></div>
      </div>

    </div>

  </div>

  <script>
    // Acertijos (1, 4 y 5) con pistas y respuestas aceptadas
    const puzzles = [
      {
        id:1,
        question: 'No soy humano, pero enseñé a hablar a la gente; no tengo boca y sin embargo cuento historias. \\\n¿Qué soy?',
        hint: 'Lo tocas para escuchar tu canción favorita.',
        answers: ['telefono','teléfono','reproductor','reproductor de audio','celular','movil','móvil']
      },
      {
        id:4,
        question: 'Me subes, me bajas; a veces soy alto, a veces bajo; reflejo pero no soy espejo. \\\n¿Qué soy?',
        hint: 'Sirvo para cambiar lo que ves o escuchas en la pantalla.',
        answers: ['volumen','brillo','el volumen','el brillo']
      },
      {
        id:5,
        question: 'Me puedes guardar, regalar, perder o robar; aunque no me toques, puedo hacerte reír o llorar. \\\n¿Qué soy?',
        hint: 'A veces lo guardas en una carpeta o lo compartes en redes.',
        answers: ['recuerdo','una foto','foto','recuerdos','momento','un recuerdo']
      }
    ];

    let currentIndex = 0;
    let score = 0;
    let player = '';

    const startBtn = document.getElementById('startBtn');
    const playerName = document.getElementById('playerName');
    const gameArea = document.getElementById('gameArea');
    const questionText = document.getElementById('questionText');
    const hintText = document.getElementById('hintText');
    const answerInput = document.getElementById('answerInput');
    const submitBtn = document.getElementById('submitBtn');
    const skipBtn = document.getElementById('skipBtn');
    const progress = document.getElementById('progress');
    const scoreD = document.getElementById('score');
    const status = document.getElementById('status');
    const finalArea = document.getElementById('finalArea');
    const finalMessage = document.getElementById('finalMessage');
    const winnerCodeArea = document.getElementById('winnerCodeArea');
    const winnerCode = document.getElementById('winnerCode');
    const restartBtn = document.getElementById('restartBtn');

    function normalize(str){
      return String(str||'').toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,'').trim();
    }

    function showQuestion(){
      const p = puzzles[currentIndex];
      questionText.textContent = p.question;
      hintText.textContent = 'Pista: ' + p.hint;
      progress.textContent = (currentIndex+1) + ' / ' + puzzles.length;
      answerInput.value = '';
      answerInput.focus();
      status.textContent = '';
    }

    startBtn.addEventListener('click', ()=>{
      player = normalize(playerName.value) || 'Jugador';
      document.getElementById('playerName').disabled = true;
      startBtn.disabled = true;
      gameArea.style.display = 'block';
      showQuestion();
    });

    submitBtn.addEventListener('click', ()=>{
      const given = normalize(answerInput.value);
      const p = puzzles[currentIndex];
      const accepted = p.answers.map(a=>normalize(a));
      if(accepted.includes(given)){
        score++;
        scoreD.textContent = score;
        status.textContent = '✅ Correcto!';
      } else {
        status.textContent = '❌ Incorrecto. Intenta de nuevo o presiona Pista.';
        return;
      }
      currentIndex++;
      if(currentIndex < puzzles.length){
        showQuestion();
      } else {
        endGame();
      }
    });

    skipBtn.addEventListener('click', ()=>{
      // Muestra la pista; si ya visible, muestra la respuesta parcial
      status.textContent = 'Pista mostrada arriba.';
    });

    function endGame(){
      document.getElementById('qCard').style.display = 'none';
      finalArea.style.display = 'block';
      if(score === puzzles.length){
        finalMessage.textContent = `¡Felicidades ${player}! Has resuelto todos los acertijos.`;
        winnerCodeArea.style.display = 'block';
        // Muestra la clave ganadora
        winnerCode.textContent = 'PzMg0000001';
      } else {
        finalMessage.textContent = `Buen intento ${player}. Respondiste ${score} de ${puzzles.length} correctamente. Intenta de nuevo para ganar la clave.`;
        winnerCodeArea.style.display = 'none';
      }
    }

    restartBtn.addEventListener('click', ()=>{
      currentIndex = 0; score = 0; player = '';
      document.getElementById('qCard').style.display = 'block';
      finalArea.style.display = 'none';
      document.getElementById('playerName').disabled = false;
      startBtn.disabled = false;
      document.getElementById('playerName').value = '';
      scoreD.textContent = '0';
      progress.textContent = '0 / ' + puzzles.length;
    });

    // Permitir enviar respuesta con Enter
    answerInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') submitBtn.click(); });
  </script>
</body>
</html>
